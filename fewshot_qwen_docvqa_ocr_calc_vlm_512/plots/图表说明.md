# 实验数据可视化图表说明

本文档说明生成的各个图表的内容和用途。

---

## 📊 生成的图表列表

### 1. `latency_analysis.png` - 延迟分析

**包含4个子图：**

1. **延迟分布直方图**
   - 显示所有样本的端到端延迟分布
   - 红色虚线：平均延迟（16.03秒）
   - 绿色虚线：中位数延迟（13.62秒）
   - **洞察**：了解延迟的分布模式，识别异常值

2. **延迟箱线图**
   - 显示延迟的四分位数、中位数和异常值
   - **洞察**：快速识别延迟的统计特征和离群点

3. **累积分布函数（CDF）**
   - 显示不同延迟阈值的累积百分比
   - P95和P99标记线
   - **洞察**：了解有多少比例的样本在特定时间内完成

4. **延迟统计摘要**
   - 详细的统计信息表格
   - 包括均值、中位数、最值、标准差、百分位数
   - **洞察**：快速查看关键统计指标

**用途**：
- 论文中的性能分析部分
- 识别性能瓶颈
- 优化系统响应时间

---

### 2. `tool_usage_analysis.png` - 工具使用分析

**包含4个子图：**

1. **工具调用分布**
   - 显示每个样本的工具调用次数分布
   - 分类：0次、1次、2次、3+次
   - **洞察**：了解工具使用的频率模式
   - **发现**：63%的样本使用了工具

2. **工具延迟分布**
   - 仅显示使用工具的样本的延迟分布
   - 平均工具延迟：2.49秒
   - **洞察**：工具调用的时间开销

3. **工具使用率饼图**
   - 使用工具 vs 不使用工具的样本比例
   - **洞察**：工具使用的整体覆盖率

4. **工具成功率**
   - 成功 vs 失败的工具调用统计
   - **发现**：100%成功率
   - **洞察**：工具系统的可靠性

**用途**：
- 论文中的工具效果分析
- 理解工具使用模式
- 优化工具选择策略

---

### 3. `token_usage_analysis.png` - Token使用分析

**包含4个子图：**

1. **Token使用分布**
   - 每个样本的总Token数分布
   - 平均：2,037 tokens/样本
   - **洞察**：Token使用的变化范围

2. **Prompt vs Completion散点图**
   - 输入Token vs 输出Token的关系
   - 相关性分析
   - **洞察**：输入输出Token的关系模式

3. **Token使用分解**
   - 总Prompt Tokens、总Completion Tokens、总Tokens
   - **洞察**：整体Token消耗的构成

4. **平均Token使用**
   - 每个样本的平均Prompt、Completion、Total Tokens
   - **洞察**：平均资源消耗

**用途**：
- 论文中的成本分析
- API费用估算
- 资源优化

---

### 4. `performance_summary.png` - 性能摘要

**包含4个子图：**

1. **准确率指标**
   - Mean ANLS: 0.431
   - Accuracy (ANLS>0.5): 40%
   - **洞察**：模型性能的核心指标

2. **正确 vs 错误预测**
   - 饼图显示正确和错误预测的比例
   - 40%正确，60%错误
   - **洞察**：整体准确率可视化

3. **性能指标对比**
   - 平均延迟、工具延迟、推理时间
   - **洞察**：不同时间组件的对比

4. **系统资源使用**
   - 峰值内存、虚拟内存、CPU时间
   - 归一化显示以便对比
   - **洞察**：系统资源消耗

**用途**：
- 论文中的主要结果展示
- 快速了解实验整体性能
- 摘要和结论部分

---

### 5. `latency_tool_correlation.png` - 延迟与工具使用相关性

**包含2个子图：**

1. **延迟 vs 工具调用次数**
   - 散点图显示工具调用次数与总延迟的关系
   - 趋势线和相关系数
   - **洞察**：工具使用是否增加延迟

2. **工具延迟 vs 总延迟**
   - 工具延迟与端到端延迟的关系
   - 仅显示使用工具的样本
   - **洞察**：工具延迟对总延迟的贡献

**用途**：
- 论文中的性能权衡分析
- 理解工具开销
- 优化工具使用策略

---

### 6. `token_latency_correlation.png` - Token与延迟相关性

**包含3个子图：**

1. **总Token vs 延迟**
   - 总Token数与延迟的关系
   - 相关性分析
   - **洞察**：Token数量是否影响延迟

2. **Prompt Token vs 延迟**
   - 输入Token数与延迟的关系
   - **洞察**：输入复杂度对延迟的影响

3. **Completion Token vs 延迟**
   - 输出Token数与延迟的关系
   - **洞察**：输出长度对延迟的影响

**用途**：
- 论文中的性能分析
- 理解Token使用与性能的关系
- 优化提示词长度

---

## 🎯 图表使用建议

### 论文中的使用

1. **Introduction/Abstract**
   - `performance_summary.png` - 主要结果概览

2. **Results Section**
   - `latency_analysis.png` - 性能详细分析
   - `tool_usage_analysis.png` - 工具效果分析
   - `token_usage_analysis.png` - 资源消耗分析

3. **Discussion Section**
   - `latency_tool_correlation.png` - 性能权衡讨论
   - `token_latency_correlation.png` - 资源与性能关系

4. **Appendix**
   - 所有图表可作为补充材料

### 演示文稿使用

- 所有图表都适合在PPT中使用
- 建议使用高分辨率版本（已设置为300 DPI）

---

## 📈 关键发现（从图表中）

### 1. 延迟特征
- **平均延迟**：16.03秒
- **延迟变化大**：标准差5.00秒
- **P95延迟**：27.72秒（95%的样本在此时间内完成）

### 2. 工具使用
- **工具使用率**：63%
- **工具成功率**：100%
- **平均工具延迟**：2.49秒（占总延迟的~15%）

### 3. Token使用
- **平均Token/样本**：2,037
- **Prompt占比**：~72%（1,460 tokens）
- **Completion占比**：~28%（577 tokens）

### 4. 性能指标
- **准确率**：40%（ANLS > 0.5）
- **Mean ANLS**：0.431
- **内存使用**：817 MB（相对较低）

### 5. 相关性发现
- **工具使用与延迟**：正相关（使用工具增加延迟）
- **Token与延迟**：可能存在相关性（需要进一步分析）

---

## 🔧 如何重新生成图表

```bash
# 为当前实验生成图表
python visualize_results.py fewshot_qwen_docvqa_ocr_calc_vlm_512

# 指定输出目录
python visualize_results.py fewshot_qwen_docvqa_ocr_calc_vlm_512 --output custom_output_dir
```

---

## 📝 注意事项

1. **图表格式**：所有图表保存为PNG格式，300 DPI分辨率
2. **颜色方案**：使用seaborn的husl调色板，确保可读性
3. **字体大小**：已优化用于论文和演示
4. **数据完整性**：如果某些数据缺失，对应的图表可能不会生成

---

**生成时间**：2025-11-30  
**实验名称**：fewshot_qwen_docvqa_ocr_calc_vlm_512

